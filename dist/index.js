class o{#e;wrapper;constructor(t){const e=document.createElement("div");e.classList.add("dpab__wrapper"),e.dataset.type=t.type,this.wrapper=e,this.#e=t.selector}enable(t){document.querySelectorAll(this.#e).forEach(e=>{const s=this.wrapper.cloneNode();e.parentNode.insertBefore(s,e),s.appendChild(e),t(s,e)})}disable(){document.querySelectorAll(this.#e).forEach(t=>{const e=t.parentNode;e.parentNode.insertBefore(t,e),e.remove()})}}class p extends o{constructor(){super({selector:"h1, h2, h3, h4, h5, h6",type:"Heading"}),this.name="Headings",this.description="Identify heading tags in the document";const t=document.createElement("span");t.classList.add("dpab__marker"),this.marker=t}enable(){super.enable((t,e)=>{const s=this.marker.cloneNode();let r=e.tagName.toLowerCase();e.classList.length?(t.classList.add("dpab__wrapper--valid"),r+=` class="${Array.from(e.classList.values()).join(" ")}"`):t.classList.add("dpab__wrapper--invalid"),s.textContent=`<${r}>`,t.prepend(s)})}}class c extends o{markers={};textHelper;constructor(t){super(t),this.markerBase=document.createElement("span"),this.markerBase.classList.add("dpab__marker");for(const[e,s]of Object.entries(t.markers)){const r=this.markerBase.cloneNode();r.innerHTML=`<strong>&lt;${t.selector}></strong> ${s}`,this.markers[e]=r}}enable(t){super.enable((e,s)=>{const r=this.textHelper(s);if(r===null)this.action("null",e);else{const l=this.#t(r);r.length===0?this.action("empty",e):r.trim().length===0?(this.action("whitespace",e),this.#e(e,l)):(this.action("normal",e),this.#e(e,l))}})}#e(t,e){const s=document.createElement("span");s.classList.add("dpab__accessible-content"),s.innerHTML=`<strong>Text alternative:</strong> ${e}`,t.append(s)}#t(t){return t.replace(/\s/g,e=>({" ":"·","	":"\\t","\n":"\\n","\r":"\\r"})[e]||e)}}class m extends c{constructor(){super({markers:{decorative:"Decorative",empty:"Empty title attribute",whitespace:"Whitespace title attribute",normal:"Accessible"},selector:"iframe",type:"Iframe"}),this.name="Inline frame (iframe)",this.description="",this.textHelper=t=>t.getAttribute("title")}action(t,e){switch(t){case"null":e.prepend(this.markers.decorative.cloneNode(!0)),e.classList.add("dpab__wrapper--valid");break;case"empty":e.prepend(this.markers.empty.cloneNode(!0)),e.classList.add("dpab__wrapper--invalid");break;case"whitespace":e.prepend(this.markers.whitespace.cloneNode(!0)),e.classList.add("dpab__wrapper--invalid");break;case"normal":e.prepend(this.markers.normal.cloneNode(!0)),e.classList.add("dpab__wrapper--valid");break}}}class h extends c{constructor(){super({markers:{missing:"Missing alt attribute",decorative:"Decorative",incorrect:"Whitespace alt attribute",normal:"Accessible"},selector:"img",type:"Image"}),this.name="Images",this.description="",this.textHelper=t=>t.getAttribute("alt")}action(t,e){switch(t){case"null":e.prepend(this.markers.missing.cloneNode(!0)),e.classList.add("dpab__wrapper--invalid");break;case"empty":e.prepend(this.markers.decorative.cloneNode(!0)),e.classList.add("dpab__wrapper--valid");break;case"whitespace":e.prepend(this.markers.incorrect.cloneNode(!0)),e.classList.add("dpab__wrapper--invalid");break;case"normal":e.prepend(this.markers.normal.cloneNode(!0)),e.classList.add("dpab__wrapper--valid");break}}}class b extends c{constructor(){super({markers:{decorative:"Decorative",empty:"Empty title tag",whitespace:"Whitespace title tag",normal:"Accessible"},selector:"svg",type:"SVG"}),this.name="Inline SVG",this.description="",this.textHelper=t=>{const e=Array.from(t.children).find(s=>s.tagName==="title");return e===void 0?null:e.textContent}}action(t,e){switch(t){case"null":e.prepend(this.markers.decorative.cloneNode(!0)),e.classList.add("dpab__wrapper--valid");break;case"empty":e.prepend(this.markers.empty.cloneNode(!0)),e.classList.add("dpab__wrapper--invalid");break;case"whitespace":e.prepend(this.markers.whitespace.cloneNode(!0)),e.classList.add("dpab__wrapper--invalid");break;case"normal":e.prepend(this.markers.normal.cloneNode(!0)),e.classList.add("dpab__wrapper--valid");break}}}const u={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_ASSET_URL:"https://raw.githubusercontent.com/designportfolio/accessibility-bookmarklet/refs/heads/main/dist/"},_=[new p,new h,new m,new b];console.log(u);const d=()=>{const a=document.querySelector(".dpab__panel");return a.classList.contains("dpab__panel--open")?a.classList.remove("dpab__panel--open"):a.classList.add("dpab__panel--open"),!0},n=(a,t=null)=>{t===null&&(t=document.body);const e=new DOMParser().parseFromString(a,"text/html");document.head.append(...e.head.childNodes);const s=e.body.childNodes;if(s.length===1)return t.appendChild(s[0]);t.append(...s)},i=(a,t,e="click")=>{a.addEventListener(e,t)},k=()=>{const a=Array.from(document.querySelectorAll(".dpab__wrapper")).map(t=>{let e;return t.classList.contains("dpab__wrapper--valid")?e="Yes":t.classList.contains("dpab__wrapper--invalid")?e="No":e="Unknown",[t.dataset.type,e]});return a.unshift(["Type","Valid"]),a},v=a=>a.map(t=>t.map(e=>'"'+e.toString().replaceAll('"','""')+'"').join(",")).join(`
`);(()=>{n('<link rel="stylesheet" href="https://raw.githubusercontent.com/designportfolio/accessibility-bookmarklet/refs/heads/main/dist/index.css">'),n(`
        <div class="dpab__panel">
            <button type="button" class="dpab__close" aria-label="Close">✕</button>
            <p>Accessibility bookmarklet</p>
            <ol></ol>
            <button type="button" class="dpab__download">Download report</button>
        </div>
    `),i(document.querySelector(".dpab__close"),()=>{document.querySelector(".dpab__panel").classList.remove("dpab__panel--open")}),i(document.querySelector(".dpab__download"),()=>{const t=k();console.log(t),v(t)});const a=document.querySelector(".dpab__panel ol");_.forEach(t=>{const e=n(`<li class=""><label title="${t.description}"><input type="checkbox"> ${t.name}</label>`,a);i(e,s=>{s.target.checked?t.enable():t.disable()},"change")}),d()})();window.dpab=d;
